'use strict';

// A tool that exits(1) if any given conditions are not met.
// Use: node assertall [options]
//    Options can be:
//    --os=<os>             OS must match one of darwin, win32 or linux.
//    --notos=<os>          OS must not match.
//    --exists=<filename>   The given file must exist.
//    --absent=<filename>   The given file doesn't exist.


var parse = require('./utils/parse');
var cond = require('./utils/conditions');

function main(argv) {
  var args = argv[1] === 'debug' ? argv.slice(3) : argv.slice(2);
  var conditions = [];

  try {
    parse(args, conditions);
  } catch (err) {
    console.error(err.message);
    process.exit(1);
  }

  cond.checkAll(conditions, function(op, val) {
    console.error("Assertion failed: "+op+"="+val);
    process.exit(1);
  });
}

main(process.argv);