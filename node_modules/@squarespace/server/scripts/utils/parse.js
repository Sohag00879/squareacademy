'use strict';

// Parses args looking for --option=value pairs from left to right. Fills the options array.
// Returns the index of the first non-option arg.
// Throws error if options are invalid.

module.exports = function(args, options) {
  for (var i=0; i<args.length; i++) {
    var arg = args[i];
    if (arg.indexOf("--") === 0) {
      var parts = arg.split('=');
      if (parts.length < 2) {
        throw new Error("Invalid option '"+arg+"'");
      }
      var op = parts[0].slice(2);
      options.push([op, parts[1]])
    } else {
      return i;
    }
  }
  return args.length;
}
